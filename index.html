<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#0b0d12">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Nakashita Hiroaki">
<link rel="apple-touch-icon" href="icons/icon-192x192.png">
<title>中島 弘秋のプロフィール</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<link rel="manifest" href="manifest.json">
</head>
<body>
<header class="site-header">
<div class="hero clickable-background">
<div class="hero-inner">
</div>
</div>
</header>
  <section class="profile-section" aria-label="プロフィール概要">
<img class="profile-avatar clickable-image" src="images/Nakashima_Icon.jpg" alt="プロフィール写真">
<h1 class="identity-name">中島 弘秋<br><span class="latin">Nakashima Hiroaki</span></h1>
</section>
<main class="card" role="main">
<section class="intro" aria-label="自己紹介">
<p>趣味: カラオケ</p>
<p>日本全都道府県を巡り中</p>
</section>

  <section class="japan-section" aria-label="日本旅行">
    <img class="japan-image clickable-image" src="images/Japan.JPG" alt="日本旅行の写真">
  </section>

  <section class="sns" aria-label="SNS リンク">
    <div class="sns-grid">
      <a class="sns-btn" href="https://www.instagram.com/nakashima.02214/" target="_blank" rel="noopener" aria-label="Instagram">
        <img src="images/Instagram copy.png" alt="Instagram">
        <span class="label">Instagram</span>
      </a>
      <a class="sns-btn" href="https://line.me/ti/p/ve7vbcQ0Zb" target="_blank" rel="noopener" aria-label="LINE">
        <img src="images/LINE.png" alt="LINE">
        <span class="label">LINE</span>
      </a>
    </div>
  </section>

  <section class="share-section" aria-label="共有・保存">
    <div class="button-group">
      <button class="share-btn" id="shareBtn">
        <span>共有</span>
      </button>
      <button class="install-btn" id="installBtn">
        <span>ホーム画面に保存</span>
      </button>
    </div>
  </section>

</main>

<footer class="footer">
  <small>© <span id="year"></span> Nakashima Hiroaki</small>
</footer>

<!-- 画像拡大モーダル -->
<div id="imageModal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="modalImage">
  <div id="caption"></div>
</div>

<script>
  document.getElementById('year').textContent = new Date().getFullYear()

  // PWA Service Worker Registration
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js');
    });
  }

  // Web Share API and Add to Home Screen Logic
  const shareBtn = document.getElementById('shareBtn');
  const installBtn = document.getElementById('installBtn');
  let deferredPrompt;

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
  });

  // 共有機能
  async function shareProfile() {
    const shareData = {
      title: '中島 弘秋 - Professional',
      text: '中島 弘秋のプロフィールをご覧ください',
      url: window.location.href
    };
    try {
      if (navigator.share) {
        await navigator.share(shareData);
      } else {
        // Web Share APIが利用できない場合のフォールバック
        if (navigator.clipboard) {
          await navigator.clipboard.writeText(window.location.href);
          alert('URLをクリップボードにコピーしました');
        } else {
          alert('このブラウザでは共有機能が利用できません');
        }
      }
    } catch (err) {
      console.error('Error sharing: ', err);
    }
  }

  // ホーム画面保存機能
  async function installToHomeScreen() {
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    const isSafari = /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent);
    const isInstalled = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true;

    if (isInstalled) {
      alert('このアプリは既にホーム画面に追加されています');
      return;
    }

    if (isIOS && isSafari) {
      showIOSInstallInstructions();
    } else if (deferredPrompt) {
      await deferredPrompt.prompt();
      deferredPrompt = null;
    } else {
      showGeneralInstallInstructions();
    }
  }

  function showIOSInstallInstructions() {
    const instructions = `ホーム画面に追加する手順\\n\\n【iPhone/iPadの場合】\\n\\nSafariでウェブサイトを開く\\n\\n画面下部（または上部）の「共有」アイコンをタップ\\n\\n「ホーム画面に追加」を選択\\n\\n「追加」をタップ`;
    alert(instructions);
  }

  function showGeneralInstallInstructions() {
    const instructions = `ホーム画面に追加する手順\\n\\n【iPhone/iPadの場合】\\n\\nSafariでウェブサイトを開く\\n\\n画面下部（または上部）の「共有」アイコンをタップ\\n\\n「ホーム画面に追加」を選択\\n\\n「追加」をタップ\\n\\n【Androidの場合 (Chrome)】\\n\\nChromeでウェブサイトを開く\\n\\n右上の「︙」メニューをタップ\\n\\n「ホーム画面に追加」を選択\\n\\n画面の指示に従い「追加」をタップ`;
    alert(instructions);
  }

  // イベントリスナーを設定
  shareBtn.addEventListener('click', shareProfile);
  installBtn.addEventListener('click', installToHomeScreen);

  // 画像拡大モーダル機能
  const modal = document.getElementById('imageModal');
  const modalImg = document.getElementById('modalImage');
  const captionText = document.getElementById('caption');
  const closeBtn = document.getElementsByClassName('close')[0];

  // クリック可能な画像にイベントリスナーを追加
  document.querySelectorAll('.clickable-image').forEach(img => {
    img.addEventListener('click', function() {
      modal.style.display = 'block';
      modalImg.src = this.src;
      captionText.innerHTML = this.alt;
    });
  });

  // 背景画像のクリック機能
  document.querySelector('.clickable-background').addEventListener('click', function() {
    modal.style.display = 'block';
    modalImg.src = 'images/Nakashima_Background.jpeg';
    captionText.innerHTML = '背景画像';
  });

  // モーダルを閉じる
  closeBtn.addEventListener('click', function() {
    modal.style.display = 'none';
  });

  // モーダル外をクリックして閉じる
  modal.addEventListener('click', function(event) {
    if (event.target === modal) {
      modal.style.display = 'none';
    }
  });

  // ESCキーでモーダルを閉じる
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape' && modal.style.display === 'block') {
      modal.style.display = 'none';
    }
  });
</script>
</body>
</html>
